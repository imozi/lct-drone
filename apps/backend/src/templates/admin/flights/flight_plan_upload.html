{% extends "admin/base_site.html" %}
{% load i18n admin_urls static %}

{% block title %}{{ title }} | {% trans 'Django site admin' %}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label='flights' %}">{% trans 'Flights' %}</a>
    &rsaquo; <a href="{% url 'admin:flights_flightplan_changelist' %}">{% trans 'Flight plans' %}</a>
    &rsaquo; {{ title }}
</div>
{% endblock %}

{% block content %}
<div class="upload-container">
    <h1>{{ title }}</h1>
    
    <div class="help-section">
        <h3>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö</h3>
        
        <div class="info-block">
            <h4>üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:</h4>
            <ul>
                <li>Excel —Ñ–∞–π–ª—ã (.xlsx, .xls)</li>
                <li>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 50MB</li>
                <li>–ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8</li>
            </ul>
        </div>

        <div class="info-block">
            <h4>üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞:</h4>
            <p>Excel —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã:</p>
            <table class="structure-table">
                <thead>
                    <tr>
                        <th>–°—Ç–æ–ª–±–µ—Ü</th>
                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th>–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>SHR</strong></td>
                        <td>–î–∞–Ω–Ω—ã–µ –ø–ª–∞–Ω–∞ –ø–æ–ª–µ—Ç–∞</td>
                        <td>SHR-ZZZZZ -ZZZZ0700 -M0020/M0030...</td>
                    </tr>
                    <tr>
                        <td><strong>DEP</strong></td>
                        <td>–î–∞–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ª–µ—Ç–∞</td>
                        <td>-TITLE IDEP -SID 7772288076...</td>
                    </tr>
                    <tr>
                        <td><strong>ARR</strong></td>
                        <td>–î–∞–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–±—ã—Ç–∏—è</td>
                        <td>-TITLE IARR -SID 7772288076...</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="warning-block">
            <h4>‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:</h4>
            <ul>
                <li>–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–µ –ø–ª–∞–Ω—ã –ø–æ–ª–µ—Ç–æ–≤</li>
                <li>–î—É–±–ª–∏–∫–∞—Ç—ã –ø–æ sid –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã</li>
                <li>–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å –≤—ã–≤–æ–¥–æ–º –æ—à–∏–±–æ–∫</li>
                <li>–ì–µ–æ–ø—Ä–∏–≤—è–∑–∫–∞ –∫ —Ä–µ–≥–∏–æ–Ω–∞–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</li>
                <li>–û–ø–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Ç–∏–ø—ã –ë–ê–° —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</li>
            </ul>
        </div>

        <div class="example-block">
            <h4>üìù –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç–æ–ª–±—Ü–µ SHR:</h4>
            <pre><code>(SHR-00725
-ZZZZ0600
-M0000/M0005 /ZONA R0,5 4408N04308E/
-ZZZZ0700
-DEP/4408N04308E DEST/4408N04308E DOF/250124
OPR/–ì–£ –ú–ß–° –†–û–°–°–ò–ò –ü–û –°–¢–ê–í–†–û–ü–û–õ–¨–°–ö–û–ú–£ –ö–†–ê–Æ
REG/00724,REG00725 STS/SAR TYP/BLA
RMK/WR655 –í –ó–û–ù–ï –í–ò–ó–£–ê–õ–¨–ù–û–ì–û –ü–û–õ–ï–¢–ê
–ê–î–ú–ò–ù–ò–°–¢–†–ê–¶–ò–Ø –ú–£–ù–ò–¶–ò–ü–ê–õ–¨–ù–û–ì–û –û–ö–†–£–ì–ê
–û–ü–ï–†–ê–¢–û–† –ò–í–ê–ù–û–í +79281234567
SID/7772251137)</code></pre>

            <h5>üîç –ß—Ç–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö:</h5>
            <ul>
                <li><strong>ID –ø–æ–ª–µ—Ç–∞:</strong> 00725</li>
                <li><strong>–í—Ä–µ–º—è –≤—ã–ª–µ—Ç–∞:</strong> 06:00 UTC</li>
                <li><strong>–í—Ä–µ–º—è –ø–æ—Å–∞–¥–∫–∏:</strong> 07:00 UTC (–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 —á–∞—Å)</li>
                <li><strong>–í—ã—Å–æ—Ç–∞ –ø–æ–ª–µ—Ç–∞:</strong> 0-5 –º–µ—Ç—Ä–æ–≤</li>
                <li><strong>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</strong> 44.133¬∞N, 43.133¬∞E</li>
                <li><strong>–î–∞—Ç–∞:</strong> 24.01.2025</li>
                <li><strong>–û–ø–µ—Ä–∞—Ç–æ—Ä:</strong> –ì–£ –ú–ß–° –†–û–°–°–ò–ò –ü–û –°–¢–ê–í–†–û–ü–û–õ–¨–°–ö–û–ú–£ –ö–†–ê–Æ</li>
                <li><strong>–¢–∏–ø –ë–ê–°:</strong> BLA (–±–µ—Å–ø–∏–ª–æ—Ç–Ω–∞—è –∞–≤–∏–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)</li>
                <li><strong>–¶–µ–ª—å:</strong> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∑–æ–Ω–µ –ø–æ–ª–µ—Ç–∞</li>
            </ul>
        </div>

        <div class="example-block">
            <h4>üìù –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç–æ–ª–±—Ü–µ DEP (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–ª–µ—Ç):</h4>
            <pre><code>-TITLE IDEP
-SID 7772251137
-ADD 250124
-ATD 0600
-ADEP ZZZZ
-ADEPZ 440846N0430829E
-PAP 0</code></pre>

            <h5>üîç –ß—Ç–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è:</h5>
            <ul>
                <li><strong>–î–∞—Ç–∞ –≤—ã–ª–µ—Ç–∞:</strong> 24.01.2025</li>
                <li><strong>–í—Ä–µ–º—è –≤—ã–ª–µ—Ç–∞:</strong> 06:00 UTC</li>
                <li><strong>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</strong> 44.146111¬∞N, 43.141389¬∞E (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ —Å–µ–∫—É–Ω–¥)</li>
            </ul>
        </div>

        <div class="example-block">
            <h4>üìù –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç–æ–ª–±—Ü–µ ARR (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–±—ã—Ç–∏–µ):</h4>
            <pre><code>-TITLE IARR
-SID 7772251137
-ADA 250124
-ATA 1250
-ADARR ZZZZ
-ADARRZ 440846N0430829E
-PAP 0</code></pre>

            <h5>üîç –ß—Ç–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è:</h5>
            <ul>
                <li><strong>–î–∞—Ç–∞ –ø—Ä–∏–±—ã—Ç–∏—è:</strong> 24.01.2025</li>
                <li><strong>–í—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è:</strong> 12:50 UTC</li>
                <li><strong>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</strong> 44.146111¬∞N, 43.141389¬∞E</li>
                <li><strong>–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> 6 —á–∞—Å–æ–≤ 50 –º–∏–Ω—É—Ç</li>
            </ul>
        </div>
    </div>

    <form method="post" enctype="multipart/form-data" class="upload-form">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="{{ form.excel_file.id_for_label }}">
                {{ form.excel_file.label }}
            </label>
            {{ form.excel_file }}
            {% if form.excel_file.help_text %}
                <div class="help-text">{{ form.excel_file.help_text }}</div>
            {% endif %}
            {% if form.excel_file.errors %}
                <div class="error-messages">
                    {% for error in form.excel_file.errors %}
                        <div class="error">{{ error }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <div class="submit-row">
            <input type="submit" value="üöÄ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–∞–π–ª" class="default" />
            <a href="{% url 'admin:flights_flightplan_changelist' %}" class="button cancel-link">
                ‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
            </a>
        </div>
    </form>

    <div class="processing-info">
        <h4>üîÑ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ:</h4>
        <ol>
            <li>–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞</li>
            <li>–ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Excel —Ñ–∞–π–ª–∞</li>
            <li>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å—Ç–æ–ª–±—Ü–æ–≤ SHR, DEP, ARR</li>
            <li>–°–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–∏—Å–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –ë–ê–°</li>
            <li>–°–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–∏—Å–∫ —Ç–∏–ø–æ–≤ –ë–ê–°</li>
            <li>–ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
            <li>–ì–µ–æ–ø—Ä–∏–≤—è–∑–∫–∞ –∫ —Ä–µ–≥–∏–æ–Ω–∞–º –†–§</li>
            <li>–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–æ–≤ –ø–æ–ª–µ—Ç–æ–≤ –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
            <li>–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –æ–± –æ–±—Ä–∞–±–æ—Ç–∫–µ</li>
        </ol>
    </div>
</div>

<style>
.upload-container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 20px;
}

.help-section {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 30px;
}

.info-block {
    margin-bottom: 20px;
    padding: 15px;
    background: white;
    border-radius: 6px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.warning-block {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 6px;
    padding: 15px;
    margin-bottom: 20px;
}

.example-block {
    background: #e8f5e8;
    border: 1px solid #c3e6c3;
    border-radius: 6px;
    padding: 15px;
    margin-bottom: 20px;
}

.example-block pre {
    background: #f8f9fa;
    padding: 10px;
    border-radius: 4px;
    overflow-x: auto;
    font-size: 12px;
    line-height: 1.4;
}

.structure-table {
    width: 100%;
    border-collapse: collapse;
    margin: 10px 0;
}

.structure-table th,
.structure-table td {
    border: 1px solid #ddd;
    padding: 8px 12px;
    text-align: left;
}

.structure-table th {
    background: #f0f0f0;
    font-weight: bold;
}

.upload-form {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 30px;
    margin-bottom: 30px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-weight: bold;
    margin-bottom: 8px;
    color: #333;
}

.form-group input[type="file"] {
    width: 100%;
    padding: 10px;
    border: 2px dashed #ddd;
    border-radius: 6px;
    background: #fafafa;
    cursor: pointer;
    transition: all 0.3s ease;
}

.form-group input[type="file"]:hover {
    border-color: #007cba;
    background: #f0f8ff;
}

.help-text {
    font-size: 12px;
    color: #666;
    margin-top: 5px;
    line-height: 1.4;
}

.error-messages {
    margin-top: 10px;
}

.error {
    background: #f8d7da;
    color: #721c24;
    padding: 8px 12px;
    border-radius: 4px;
    margin-bottom: 5px;
    border-left: 3px solid #dc3545;
}

.submit-row {
    display: flex;
    gap: 15px;
    align-items: center;
    margin-top: 25px;
}

.submit-row input[type="submit"] {
    background: linear-gradient(135deg, #28a745, #20c997);
    color: white;
    padding: 12px 25px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.submit-row input[type="submit"]:hover {
    background: linear-gradient(135deg, #218838, #1ea58a);
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.cancel-link {
    background: linear-gradient(135deg, #6c757d, #5a6268);
    color: white;
    padding: 12px 25px;
    text-decoration: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.cancel-link:hover {
    background: linear-gradient(135deg, #5a6268, #495057);
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    color: white;
    text-decoration: none;
}

.processing-info {
    background: #e3f2fd;
    border: 1px solid #bbdefb;
    border-radius: 8px;
    padding: 20px;
}

.processing-info ol {
    margin: 10px 0;
    padding-left: 20px;
}

.processing-info li {
    margin: 8px 0;
    line-height: 1.4;
}

h1 {
    color: #333;
    border-bottom: 2px solid #007cba;
    padding-bottom: 10px;
    margin-bottom: 30px;
}

h3 {
    color: #007cba;
    margin-top: 0;
}

h4 {
    color: #495057;
    margin: 15px 0 10px 0;
}

/* Responsive design */
@media (max-width: 768px) {
    .upload-container {
        padding: 10px;
    }
    
    .submit-row {
        flex-direction: column;
        align-items: stretch;
    }
    
    .submit-row input[type="submit"],
    .cancel-link {
        text-align: center;
        width: 100%;
    }
    
    .structure-table {
        font-size: 12px;
    }
    
    .structure-table th,
    .structure-table td {
        padding: 6px;
    }
}
</style>

<script>
// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
document.addEventListener('DOMContentLoaded', function() {
    const fileInput = document.querySelector('input[type="file"]');
    if (fileInput) {
        fileInput.addEventListener('change', function(e) {
            const fileName = e.target.files[0]?.name;
            if (fileName) {
                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
                let fileNameDisplay = document.querySelector('.file-name-display');
                if (!fileNameDisplay) {
                    fileNameDisplay = document.createElement('div');
                    fileNameDisplay.className = 'file-name-display';
                    e.target.parentNode.appendChild(fileNameDisplay);
                }
                fileNameDisplay.textContent = `–í—ã–±—Ä–∞–Ω —Ñ–∞–π–ª: ${fileName}`;
                fileNameDisplay.style.marginTop = '10px';
                fileNameDisplay.style.color = '#28a745';
                fileNameDisplay.style.fontWeight = 'bold';
            }
        });
    }
});
</script>
{% endblock %}